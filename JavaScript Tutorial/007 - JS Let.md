# JavaScript Let

---

## ECMAScript 2015

​	JavaScript ES2015 ได้มีการนำคีย์เวิร์ดที่สำคัญ 2 ตัวมาใช้นั้นก็คือ `let` และ `const` โดยค่าของตัวแปรที่ประกาศโดยคีย์เวิร์ดเหล่านี้จะถูกใช้ได้เฉพาะใน Block Scope ใน JavaScript ก่อนหน้า ES2015 JavaScript ได้มีประเภทของ Scope อยู่ 2 ประเภท นั้นก็คือ Global Scope และ Function Scope

---

## Global Scope

​	ในการประกาศตัวแปรแบบ Global จะต้องถูกประกาศอยู่ด้านนอกฟังก์ชั่น โดยตัวแปร Global จะสามารถถูกเข้าถึงได้จากทุกที่ภายในโค้ต

```js
var carName = "Volvo";

// โค้ตตรงนี้สามารถใช้ตัวแปร carName ได้

function myFunction() {
  // โค้ตตรงนี้สามารถใช้ตัวแปร carName ได้เช่นกัน
}
```

---

## Function Scope

​	ในการประกาศตัวแปรแบบ Function Scope ตัวแปรนั้นจะต้องอยู่ในฟังก์ชั่นเท่านั้น และตัวแปรนี้ไม่สามารถเข้าถึงได้จากภายนอกฟังก์ชั่น มีเพียงภายในฟังก์ชั่นด้วยกันเองเท่านั้นที่สามารถเข้าถึงได้ ตัวอย่างเช่น

```js
// โค้ตตรงนี้ไม่สามารถเข้าถึงตัวแปร carName ได้

function myFunction() {
  var carName = "Volvo";
  // โค้ตตรงนี้สามารถเข้าถึงตัวแปร carName ได้
}

// โค้ตตรงนี้ไม่สามารถเข้าถึงตัวแปร carName ได้
```

---

## Block Scope

​	การประกาศตัวแปรด้วย `var` จะไม่สามารถมี Block Scope ได้ ตัวแปรที่ประกาศด้วย `var` ที่อยู่ด้านในบล็อคโค้ต `{}` จะสามารถเข้าถึงจากด้านนอกบล็อคโค้ตได้

```js
{
  var x = 2;
}
// ตัวแปร x สามารถนำมาใช้ตรงนี้ได้
```

ก่อน ES2015 JavaScript ไม่มี Block Scope แต่ในปัจจุบันตัวแปรที่ประกาศด้วย `let` สามารถมี Block Scope ได้ และตัวแปรนี้จะต้องถูกประกาศอยู่ภายในบล็อคโค้ต `{}` โดยตัวแปรนี้จะไม่สามารถเข้าถึงได้จากภายนอก

```js
{
  let x = 2;
}
// ไม่สามารถเข้าถึงตัวแปร x ได้
```

---

## การประกาศตัวแปรเดิม

​	ในการประกาศตัวแปรเดิมด้วย `var` อาจจะทำให้เกิดปัญหาได้ การประกาศตัวแปรเดิมภายนอกบล็อคโค้ต จะเป็นการประกาศตัวแปรเดียวกันกับตัวที่อยู่ในบล็อคโค้ต ตัวอย่างเช่น

```js
var x = 10;
// ตรงนี้ x มีค่าเท่ากับ 10
{
  var x = 2;
  // ตรงนี้ x มีค่าเท่ากับ 2
}
// ถ้าหากเราเรียกใช้ตัวแปร x ค่าของตัวแปรจะเท่ากับ 2
```

​	การประกาศตัวแปรเดิมโดยใช้ `let` จะสามารถแก้ไขปัญหานี้ได้ ในการประกาศตัวแปรเดิม ตัวแปรที่อยู่ในบล็อคโค้ต และอยู่นอกบล็อคโค้ตจะถือว่าเป็นคนละข้อมูลกัน ตัวอย่างเช่น

```js
var x = 10;
// ตรงนี้ x มีค่าเท่ากับ 10
{
  let x = 2;
  // ตรงนี้ x มีค่าเท่ากับ 2
}
// ตรงนี้ x มีค่าเท่ากับ 10 เพราะ x ในบรรทัดที่ 4 ถูกประกาศภายในบล็อคโค้ต ข้อมูลจึงถูกกำหนดให้อยู่ในบล็อคโค้ตเท่านั้น
```

---

## ขอบเขตของการใช้ Loop

​	การใช้ `var` ใน loop

```js
var i = 5;
for (var i = 0; i < 10; i++) {
  // some statements
}
// ตรงนี้ตัวแปร i จะมีค่าเท่ากับ 10
```

​	การใช้ `let` ใน loop

```js
let i = 5;
for (let i = 0; i < 10; i++) {
  // some statements
}
// ตรงนี้ตัวแปร i จะมีค่าเท่ากับ 5
```

​	ในตัวอย่างแรกเราใช้ `var` ในการประกาศตัวแปร `i` และในลูปก็ทำการประกาศตัวแปร `i` ขึ้นมาอีกครั้ง จะเห็นได้ว่าในการประกาศตัวแปรในลูป จะนำค่า `i` ที่ประกาศไว้ก่อนหน้านี้มาใช้ แล้วหลังจากนี้ หากเข้าถึงตัวแปร `i` จะเป็นการนำข้อมูลที่เกิดขึ้นจากการลูปมาใช้ ต่างจากการประกาศตัวแปรด้วย `let` จะเห็นว่ามีการประกาศตัวแปรซ้ำ โดยในลูปก็จะนำค่าของตัวแปร `i` มาลูปด้วยเช่นกัน แต่จะแตกต่างตรงที่ เมื่อมีการเข้าถึงข้อมูลตัวแปร `i` จากด้านนอกลูป จะเป็นการนำค่าตัวแปร `i` ที่ประกาศไว้ครั้งแรกสุดมาใช้แทน

---

## Function Scope

​	ตัวแปรประเภท `var` และ `let`จะคล้ายคลึงกันเมื่อถูกประกาศภายในฟังก์ชั่น ตัวอย่างเช่น

```js
function myFunction() {
  var carName = "Volvo";   // Function Scope
}
function myFunction() {
  let carName = "Volvo";   // Function Scope
}
```

---

## Global Scope

​	ตัวแปรประเภท `var` และ `let`จะคล้ายคลึงกันเมื่อถูกประกาศภายนอกของโค้ตบล็อค โดยทั้งสองแบบสามารถเป็น Global Scope ได้

```js
var x = 2;       // Global scope
let x = 2;       // Global scope
```

---

## ตัวแปร Global ใน HTML

​	ตัวแปรแบบ Global ใน JavaScript สามารถใช้ได้ปกติในโค้ตของ JavaScipt แต่ใน HTML global scope จะหมายถึง window object

การประกาศตัวแปรประเภท `var` เป็น Global ตัวแปรนั้นจะเป็น window object ตัวอย่างเช่น

```js
var carName = "Volvo";
// ตรงนี้เราสามารถใช้ window.carName ได้
```

การประกาศตัวแปรประเภท `let` เป็น Global ตัวแปรนั้จะไม่ได้เป็น window object ตัวอย่างเช่น

```js
let carName = "Volvo";
// ตรงนี้เราไม่สามารถใช้ window.carName ได้
```

---

## การประกาศตัวแปรเดิม

​	ในการประกาศตัวแปรเดิมใน JavaScript ตัวแปร `var` จะอนุญาตให้ประกาศซ้ำได้ที่ไหนก็ได้ภายในโปรแกรม ตัวอย่างเช่น

```js
var x = 2;

// Now x is 2
 
var x = 3;

// Now x is 3
```

​	ในการประกาศตัวแปรเดิมใน JavaScript ตัวแปร `let` จะไม่สามารถประกาศตัวแปรซ้ำภายในบล็อคโค้ตได้ ตัวอย่างเช่น

```js
var x = 2;       // อนุญาตให้ประกาศตัวแปรได้
let x = 3;       // ไม่อนุญาตให้ประกาศตัวแปรได้

{
  var x = 4;   // อนุญาตให้ประกาศตัวแปรได้
  let x = 5   // ไม่อนุญาตให้ประกาศตัวแปรได้
}
```

​	ในการประกาศตัวแปรเดิมแบบ `let` ด้วย `let` ที่อยู่ภายในบล็อคโค้ตเดียวกันจะไม่อนุญาตให้ใช้ได้เช่นกัน ตัวอย่างเช่น

```js
let x = 2;       // อนุญาตให้ประกาศตัวแปรได้
var x = 3;       // ไม่อนุญาตให้ประกาศตัวแปรได้

{
  let x = 4;   // อนุญาตให้ประกาศตัวแปรได้
  var x = 5;   // ไม่อนุญาตให้ประกาศตัวแปรได้
}
```

​	แต่ประกาศตัวแปรเดิมแบบ `let` ที่อยู่คนละบล็อคโค้ต จะสามารถประกาศได้ ตัวอย่างเช่น

```js
let x = 2;       // อนุญาตให้ประกาศตัวแปรได้

{
  let x = 3;   // อนุญาตให้ประกาศตัวแปรได้
}

{
  let x = 4;   // อนุญาตให้ประกาศตัวแปรได้
}
```

---

## Hoisting

​	ตัวแปรที่ประกาศด้วย `var` จะติด **hoisted** ไปยังบนสุดของคำสั่งทั้งหมด และสามารถเรียกใช้งานได้ตลอดเวลา หมายความว่า เราสามารถใช้ตัวแปรได้ก่อนที่เราจะประกาศ ตัวอย่างเช่น

```js
//โค้ตสามารถทำงานได้
carName = "Volvo";
alert(carName);
var carName;
```

​	ตัวแปรที่ประกาศด้วย `let` จะติด hoisted ไปยังบนสุดของบล็อคโค้ต แต่จะไม่สามารถเรียกใช้งานได้ หมายความว่า บล็อคโค้ตจะรับรู้ถึงการมีอยู่ของตัวแปร แต่จะไม่สามารถเรียกใช้งานก่อนได้ จนกว่าตัวแปรนั้นจะถูกประกาศ ถ้าเราเรียกใช้ตัวแปรก่อนที่เราจะประกาศ โปรแกรมจะไม่สามารถทำงานได้ โดยโปรแกรมจะแจ้ง error ว่า `ReferenceError` ตัวอย่างเช่น

```js
//โค้ตจะไม่สามารถทำงานได้ และจะแสดงผลลัพธ์ว่า ReferenceError
carName = "Volvo";
let carName;
```

> ผมจะพูดเรื่องของ Hoisting เพิ่มเติม ในหัวข้อที่เกี่ยวกับ Hoisting โดยเฉพาะ



​	